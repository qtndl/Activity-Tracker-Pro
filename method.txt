            
            await session.commit()
            logger.info(f"âœ… ÐžÐ±Ð½Ð¾Ð²Ð»ÐµÐ½Ð¾ {updated_count} DBMessage Ð·Ð°Ð¿Ð¸ÑÐµÐ¹ Ð´Ð»Ñ ÑÐµÑÑÐ¸Ð¸ ÐºÐ»Ð¸ÐµÐ½Ñ‚Ð° ID {client_telegram_id} Ð² Ñ‡Ð°Ñ‚Ðµ {chat_id}. ÐžÑ‚Ð²ÐµÑ‚Ð¸Ð»: ÑÐ¾Ñ‚Ñ€ÑƒÐ´Ð½Ð¸Ðº ID {responding_employee_id}.")

        # Ð£Ð´Ð°Ð»ÑÐµÐ¼ Ð¸Ð· Ð¾Ñ‚ÑÐ»ÐµÐ¶Ð¸Ð²Ð°ÐµÐ¼Ñ‹Ñ… `pending_messages` Ð²ÑÐµ Ð¾Ð±Ñ€Ð°Ð±Ð¾Ñ‚Ð°Ð½Ð½Ñ‹Ðµ ÑÐ¾Ð¾Ð±Ñ‰ÐµÐ½Ð¸Ñ ÑÑ‚Ð¾Ð³Ð¾ ÐºÐ»Ð¸ÐµÐ½Ñ‚Ð°
        # self.pending_messages Ñ‚ÐµÐ¿ÐµÑ€ÑŒ Ð½Ðµ Ñ‚Ð°Ðº ÐºÑ€Ð¸Ñ‚Ð¸Ñ‡ÐµÐ½, ÐµÑÐ»Ð¸ ÑƒÐ²ÐµÐ´Ð¾Ð¼Ð»ÐµÐ½Ð¸Ñ Ð¿Ð»Ð°Ð½Ð¸Ñ€ÑƒÑŽÑ‚ÑÑ Ð¿Ð¾-Ð½Ð¾Ð²Ð¾Ð¼Ñƒ
        if chat_id in self.pending_messages:
            client_messages_in_pending_keys = list(self.pending_messages[chat_id].keys())
            removed_from_pending_count = 0
            for client_message_telegram_id_key in client_messages_in_pending_keys:
                if client_message_telegram_id_key in processed_client_message_telegram_ids_for_pending_removal:
                    del self.pending_messages[chat_id][client_message_telegram_id_key]
                    removed_from_pending_count +=1
            
            if removed_from_pending_count > 0:
                logger.info(f"ðŸ—‘ Ð£Ð´Ð°Ð»ÐµÐ½Ð¾ {removed_from_pending_count} Ð·Ð°Ð¿Ð¸ÑÐµÐ¹ Ð¸Ð· pending_messages Ð´Ð»Ñ Ñ‡Ð°Ñ‚Ð° {chat_id} (ÐºÐ»Ð¸ÐµÐ½Ñ‚ {client_telegram_id}).")
            
            if not self.pending_messages[chat_id]: 
                del self.pending_messages[chat_id]
                logger.info(f"ðŸ—‘ Ð£Ð´Ð°Ð»ÐµÐ½ ÐºÐ»ÑŽÑ‡ Ñ‡Ð°Ñ‚Ð° {chat_id} Ð¸Ð· pending_messages, Ñ‚.Ðº. Ð¾Ð½ Ð¿ÑƒÑÑ‚.")
    
    async def mark_as_deleted(self, chat_id: int, message_id: int): # message_id Ð·Ð´ÐµÑÑŒ ÑÑ‚Ð¾ Telegram message_id
        """ÐžÑ‚Ð¼ÐµÑ‚ÐºÐ° ÑÐ¾Ð¾Ð±Ñ‰ÐµÐ½Ð¸Ñ ÐºÐ°Ðº ÑƒÐ´Ð°Ð»ÐµÐ½Ð½Ð¾Ð³Ð¾"""
        logger.info(f"ðŸ—‘ Ð¡Ð¾Ð¾Ð±Ñ‰ÐµÐ½Ð¸Ðµ Telegram.ID={message_id} ÑƒÐ´Ð°Ð»ÐµÐ½Ð¾ Ð² Ñ‡Ð°Ñ‚Ðµ {chat_id}")
        
        # ÐžÐ±Ð½Ð¾Ð²Ð»ÑÐµÐ¼ Ð² Ð‘Ð” Ð’Ð¡Ð• ÐºÐ¾Ð¿Ð¸Ð¸ ÑÑ‚Ð¾Ð³Ð¾ ÑÐ¾Ð¾Ð±Ñ‰ÐµÐ½Ð¸Ñ (Ð´Ð»Ñ Ð²ÑÐµÑ… ÑÐ¾Ñ‚Ñ€ÑƒÐ´Ð½Ð¸ÐºÐ¾Ð²)
        async with AsyncSessionLocal() as session:
            result = await session.execute(
                select(DBMessage).where(
                    and_(
                        DBMessage.chat_id == chat_id,
                        DBMessage.message_id == message_id # Ð˜ÑÐ¿Ð¾Ð»ÑŒÐ·ÑƒÐµÐ¼ Telegram message_id Ð´Ð»Ñ Ð¿Ð¾Ð¸ÑÐºÐ° Ð²ÑÐµÑ… ÐºÐ¾Ð¿Ð¸Ð¹
                    )
                )
            )
            db_message_copies = result.scalars().all()
            
                logger.info(f"ðŸ—‘ Ð£Ð´Ð°Ð»ÐµÐ½Ð¾ {removed_from_pending_count} Ð·Ð°Ð¿Ð¸ÑÐµÐ¹ Ð¸Ð· pending_messages Ð´Ð»Ñ Ñ‡Ð°Ñ‚Ð° {chat_id} (ÐºÐ»Ð¸ÐµÐ½Ñ‚ {client_telegram_id}).")
            
            if not self.pending_messages[chat_id]: 
                del self.pending_messages[chat_id]
                logger.info(f"ðŸ—‘ Ð£Ð´Ð°Ð»ÐµÐ½ ÐºÐ»ÑŽÑ‡ Ñ‡Ð°Ñ‚Ð° {chat_id} Ð¸Ð· pending_messages, Ñ‚.Ðº. Ð¾Ð½ Ð¿ÑƒÑÑ‚.")
    
    async def mark_as_deleted(self, chat_id: int, message_id: int): # message_id Ð·Ð´ÐµÑÑŒ ÑÑ‚Ð¾ Telegram message_id
        """ÐžÑ‚Ð¼ÐµÑ‚ÐºÐ° ÑÐ¾Ð¾Ð±Ñ‰ÐµÐ½Ð¸Ñ ÐºÐ°Ðº ÑƒÐ´Ð°Ð»ÐµÐ½Ð½Ð¾Ð³Ð¾"""
        logger.info(f"ðŸ—‘ Ð¡Ð¾Ð¾Ð±Ñ‰ÐµÐ½Ð¸Ðµ Telegram.ID={message_id} ÑƒÐ´Ð°Ð»ÐµÐ½Ð¾ Ð² Ñ‡Ð°Ñ‚Ðµ {chat_id}")
        
        # ÐžÐ±Ð½Ð¾Ð²Ð»ÑÐµÐ¼ Ð² Ð‘Ð” Ð’Ð¡Ð• ÐºÐ¾Ð¿Ð¸Ð¸ ÑÑ‚Ð¾Ð³Ð¾ ÑÐ¾Ð¾Ð±Ñ‰ÐµÐ½Ð¸Ñ (Ð´Ð»Ñ Ð²ÑÐµÑ… ÑÐ¾Ñ‚Ñ€ÑƒÐ´Ð½Ð¸ÐºÐ¾Ð²)
        async with AsyncSessionLocal() as session:
            result = await session.execute(
                select(DBMessage).where(
                    and_(
                        DBMessage.chat_id == chat_id,
                        DBMessage.message_id == message_id # Ð˜ÑÐ¿Ð¾Ð»ÑŒÐ·ÑƒÐµÐ¼ Telegram message_id Ð´Ð»Ñ Ð¿Ð¾Ð¸ÑÐºÐ° Ð²ÑÐµÑ… ÐºÐ¾Ð¿Ð¸Ð¹
                    )
                )
            )
            db_message_copies = result.scalars().all()
            
            if not db_message_copies:
                logger.warning(f"ÐÐµ Ð½Ð°Ð¹Ð´ÐµÐ½Ð¾ DBMessage Ð·Ð°Ð¿Ð¸ÑÐµÐ¹ Ð´Ð»Ñ Telegram.ID={message_id} Ð² Ñ‡Ð°Ñ‚Ðµ {chat_id} Ð´Ð»Ñ Ð¿Ð¾Ð¼ÐµÑ‚ÐºÐ¸ ÐºÐ°Ðº ÑƒÐ´Ð°Ð»ÐµÐ½Ð½Ð¾Ðµ.")
                return

            deleted_count = 0
            for db_message_copy in db_message_copies:
                if not db_message_copy.is_deleted:  # Ð•ÑÐ»Ð¸ ÐµÑ‰Ðµ Ð½Ðµ Ð¿Ð¾Ð¼ÐµÑ‡ÐµÐ½Ð¾ ÐºÐ°Ðº ÑƒÐ´Ð°Ð»ÐµÐ½Ð½Ð¾Ðµ
                    db_message_copy.is_deleted = True
                    db_message_copy.deleted_at = datetime.utcnow()
                    
                    # ÐžÑ‚Ð¼ÐµÐ½ÑÐµÐ¼ ÑƒÐ²ÐµÐ´Ð¾Ð¼Ð»ÐµÐ½Ð¸Ñ Ð´Ð»Ñ ÑÑ‚Ð¾Ð³Ð¾ ÐºÐ¾Ð½ÐºÑ€ÐµÑ‚Ð½Ð¾Ð³Ð¾ DBMessage.id
                    await self.notifications.cancel_notifications(db_message_copy.id)
                    deleted_count +=1 
                    logger.info(f"âœ… Ð¡Ð¾Ð¾Ð±Ñ‰ÐµÐ½Ð¸Ðµ DBMessage.id={db_message_copy.id} (Telegram.ID={message_id}) Ð¿Ð¾Ð¼ÐµÑ‡ÐµÐ½Ð¾ ÐºÐ°Ðº ÑƒÐ´Ð°Ð»ÐµÐ½Ð½Ð¾Ðµ Ð´Ð»Ñ ÑÐ¾Ñ‚Ñ€ÑƒÐ´Ð½Ð¸ÐºÐ° {db_message_copy.employee_id}")
            
            if deleted_count > 0:
                await session.commit()
